# 주제 분석

## 만들어야 할 애플리케이션의 조건

- 팀별로 제시 받은 주제에 대해서 최소 요구사항에 대한 API 문서를 제작하고, 서버를 구현합니다.
- 각 주제는 동일하게 7개의 최소 요구사항을 가지고 있습니다.


### 쇼핑몰

- 사용자는 모든 상품을 조회할 수 있다
- 사용자는 특정 분류의 상품을 조회할 수 있다(예: 상품 ID / 상품분류 / 브랜드명 / 가격 / 상품명 등)
- 사용자의 타입이 판매자인 경우 자신의 상품을 등록할 수 있다
- 사용자는 상품을 장바구니에 담을 수 있다
- 사용자는 자신의 장바구니를 조회할 수 있다
- 사용자는 자신의 장바구니에 있는 상품의 수량을 변경시킬 수 있다
- 사용자는 상품을 자신의 장바구니에서 제외할 수 있다

### LMS(학습 관리 시스템)

- 사용자는 모든 수업을 조회할 수 있다
- 사용자는 특정 분류의 수업을 조회할 수 있다(예: 강의자/ 수업명 / 수업코드 등)
- 사용자는 수업을 수강신청 할 수 있다
- 사용자는 모든 수강중인 수업을 조회할 수 있다
- 사용자는 이메일 정보와 같은 개인정보를 변경할 수 있다
- 사용자의 타입이 강의자일 경우 새로운 수업을 생성할 수 있다
- 사용자는 수업에 대한 수강신청을 취소 할 수 있다


***

# 데이터베이스 설계

## 관계형 데이터베이스

구조화된 데이터는 하나의 테이블로 표현할 수 있습니다. 사전에 정의된 테이블을 relation 이라고도 부르기 때문에, 테이블을 사용하는 데이터베이스를 관계형 데이터베이스(Relational database)라고 합니다.

다음은 관계형 데이터베이스를 학습하면서, 반드시 알고 있어야 하는 키워드입니다.

- 데이터(data): 각 항목에 저장되는 값입니다.
- 테이블(table; 또는 relation) : 사전에 정의된 열의 데이터 타입대로 작성된 데이터가 행으로 축적됩니다.
- 칼럼(column; 또는 field) : 테이블의 한 열을 가리킵니다.
- 레코드(record; 또는 tuple) : 테이블의 한 행에 저장된 데이터입니다.
- 키(key) : 테이블의 각 레코드를 구분할 수 있는 값입니다. 각 레코드마다 고유한 값을 가집니다. 기본키(primary key)와 외래키(foreign key) 등이 있습니다.

## 관계 종류

테이블과 테이블 사이의 관계는 다음과 같습니다.

- 1:1 관계
- 1:N 관계
- N:N 관계

테이블 스스로 관계를 가질 수도 있습니다.

- self referencing 관계

### 1:1 관계
하나의 레코드가 다른 테이블의 레코드 한 개와 연결된 경우입니다. 다음과 같이 User 테이블과 Phonebook 테이블이 있다고 가정하겠습니다.

![image](https://user-images.githubusercontent.com/91415701/229445104-a1b45ea3-9354-40dc-8856-b1484e08e8ba.png)

[그림] User table과 Phonebook table의 1:1 관계

User 테이블은 user_id, name, phone_id를 가지고 있습니다. 이 중 phone_id는 외래키(foreign key)로써, Phonebook 테이블의 phone_id와 연결되어 있습니다. Phonebook 테이블은 phone_id와 phone_number를 가지고 있습니다.

각 전화번호가 단 한 명의 유저와 연결되어 있고, 그 반대도 동일하다면, User 테이블과 Phonebook 테이블은 1:1 관계(One-to-one relationship)입니다.

그러나 1:1 관계는 자주 사용하지 않습니다. 1:1로 나타낼 수 있는 관계라면 User 테이블에 phone_id를 대신해 phone_number를 직접 저장하는 게 나을 수 있습니다.

### 1:N 관계

하나의 레코드가 서로 다른 여러 개의 레코드와 연결된 경우입니다. User 테이블과 Phonebook 테이블의 관계를 다음과 같이 가정하겠습니다.

![image](https://user-images.githubusercontent.com/91415701/229445182-ece7be91-4aa0-484a-9bda-c5e08c36b5c7.png)

[그림] User table과 Phonebook table의 1:N 관계

이 구조에서는 한 명의 유저가 여러 전화번호를 가질 수 있습니다. 그러나 여러 명의 유저가 하나의 전화번호를 가질 수는 없습니다. 이런 1:N(일대다) 관계는 관계형 데이터베이스에서 가장 많이 사용합니다.

### N:N 관계

여러 개의 레코드가 다른 테이블의 여러 개의 레코드와 관계가 있는 경우입니다. N:N(다대다) 관계를 위해 스키마를 디자인할 때에는, Join 테이블을 만들어 관리합니다. 1:N(일대다) 관계와 비슷하지만, 양방향에서 다수의 레코드를 가질 수 있습니다.

다음과 같이 여행 상품을 관리하는 테이블이 있다고 가정하겠습니다. 여러 개의 여행 상품이 있고, 여러 명의 고객이 있습니다. 고객 한 명은 여러 개의 여행 상품을 구매할 수 있고, 여행 상품 하나는 여러 명의 고객이 구매할 수 있습니다.

![image](https://user-images.githubusercontent.com/91415701/229445283-0965dd67-ce79-43d0-a100-05e1bda1268b.png)

[그림] Customer table과 Package table

이렇게 Customer 테이블과 Package table이 따로 존재한다면, N:N(다대다) 관계를 어떻게 표현할 수 있을까요? 다대다 관계는 두 개의 일대다 관계와 그 모양이 같습니다. 두 개의 테이블과 1:N(일대다) 관계를 형성하는 새로운 테이블로 N:N(다대다) 관계를 나타낼 수 있습니다.

이렇게 다대다 관계를 위한 테이블을 조인 테이블이라고 합니다. N:N(다대다) 관계를 그림으로 나타내면 다음과 같습니다.

Customer table과 Package table의 N:N 관계를 위해 customer_package 테이블을 생성

![image](https://user-images.githubusercontent.com/91415701/229445330-cca627d3-d373-4bfd-8ba0-217a6ca89216.png)
customer_package 테이블에서는 고객 한 명이 여러 개의 여행 상품을 가질 수 있고, 여행 상품 하나를 여러 명의 고객이 가질 수 있습니다.

customer_package 테이블은 customer_id와 package_id를 묶어주는 역할입니다. 이 테이블을 통해 어떤 고객이 몇 개의 여행 상품을 구매했는지 또는, 어떤 여행 상품이 몇 명의 고객을 가지고 있는지 등을 확인할 수 있습니다. 이렇게 조인 테이블을 생성하더라도, 조인 테이블을 위한 기본키(여기서는 cp_id)는 반드시 있어야 합니다.

만약 외래키를 리스트 형식으로 관리하는 필드가 있다면, 어떤 문제가 발생할 수 있을까요?

### 자기참조 관계(Self Referencing Relationship)
때로는 테이블 내에서도 관계가 필요합니다. 예를 들어 추천인이 누구인지 파악하기 위해 사용할 수 있습니다.

다음과 같이 유저 테이블이 있습니다. user_id는 기본 키(primary key), name은 사용자의 이름, 그리고 recommend_id는 추천인 아이디입니다.

![image](https://user-images.githubusercontent.com/91415701/229445395-5c85fa3d-6ec8-460d-904a-4d7e5a928bf2.png)

[그림] 자기참조 관계를 가지는 User table

User 테이블의 recommend_id는 User 테이블의 user_id와 연결되어 있습니다. 한 명의 유저(user_id)는 한 명의 추천인(recommend_id)를 가질 수 있습니다. 그러나 여러 명이 한 명의 유저를 추천인으로 등록할 수 있습니다. 이 관계는 1:N(일대다) 관계와 유사하다고 생각할 수 있습니다. 그러나 일반적으로 일대다 관계는 서로 다른 테이블의 관계를 나타낼 때 표현하는 방법입니다.


***

# ERD 및 API 문서 제작

## 업무 배분
- 기능, 데이터 모델링, API 디자인은 다같이 논의하세요.
- 팀 레포 issues 탭을 사용해서 팀 회의록을 작성하세요 (실습과제 개요의 Team_Doc.md 참고)
- 논의 마무리 후 문서, 슬라이드, 이미지 작성 시 API 문서 작성 / 기능 발표 준비 / ERD 작성을 1~2인이 분담하면 적절합니다.

## ERD 제작
- ERD을 준비합니다.
  - https://dbdiagram.io/home 을 이용합니다.
  - ERD 예시 (출처: Adobe Experience League)
  - ![image](https://user-images.githubusercontent.com/91415701/229445646-7a90f319-c770-4f81-a1bf-b2bf6918d5a2.png)
  - 실습과제 개요의 ERD.md를 참고하여 링크를 기입하고, 파일을 업로드해주세요.

## API 문서 제작

- 실습과제 개요의 "API.md 작성 예시"를 참고해서 API.md를 완성하세요.
- openapi stack에 능숙하다면 Swagger로 작성 후 링크를 첨부해도 좋습니다.
- API 문서에 다음을 반드시 포함해야 합니다.
  - Method : GET, POST, DELETE 등
  - Path
  - Request : (POST, PUT의 경우) 요청에 필요한 요소(헤더, 바디 등) 예제
  - Response
    - Response 코드
    - 성공시 응답 본문 예제

- API 문서 예시 (출처: LINE Engineering)

![image](https://user-images.githubusercontent.com/91415701/229445869-f528b38c-b8e4-48f2-aee4-6ff89a15af31.png)